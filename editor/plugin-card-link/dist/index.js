"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=function(){return t=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var o in n=arguments[e])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t},t.apply(this,arguments)};"function"==typeof SuppressedError&&SuppressedError;const n=function(t){if(null==t)return r;if("function"==typeof t)return e(t);if("object"==typeof t)return Array.isArray(t)?function(t){const r=[];let o=-1;for(;++o<t.length;)r[o]=n(t[o]);return e(i);function i(...t){let n=-1;for(;++n<r.length;)if(r[n].apply(this,t))return!0;return!1}}(t):function(t){const n=t;return e(r);function r(e){const r=e;let o;for(o in t)if(r[o]!==n[o])return!1;return!0}}(t);if("string"==typeof t)return function(t){return e(n);function n(n){return n&&n.type===t}}(t);throw new Error("Expected function, string, or object as test")};function e(t){return function(n,e,r){return Boolean(function(t){return null!==t&&"object"==typeof t&&"type"in t}(n)&&t.call(this,n,"number"==typeof e?e:void 0,r||void 0))}}function r(){return!0}const o=[],i=!0,a=!1,c="skip";function u(t,e,r,u){let l;"function"==typeof e&&"function"!=typeof r?(u=r,r=e):l=e;const s=n(l),d=u?-1:1;!function t(n,l,f){const v=n&&"object"==typeof n?n:{};if("string"==typeof v.type){const t="string"==typeof v.tagName?v.tagName:"string"==typeof v.name?v.name:void 0;Object.defineProperty(p,"name",{value:"node ("+n.type+(t?"<"+t+">":"")+")"})}return p;function p(){let v,p,m,y=o;if((!e||s(n,l,f[f.length-1]||void 0))&&(y=function(t){if(Array.isArray(t))return t;if("number"==typeof t)return[i,t];return null==t?o:[t]}(r(n,f)),y[0]===a))return y;if("children"in n&&n.children){const e=n;if(e.children&&y[0]!==c)for(p=(u?e.children.length:-1)+d,m=f.concat(e);p>-1&&p<e.children.length;){const n=e.children[p];if(v=t(n,p,m)(),v[0]===a)return v;p="number"==typeof v[1]?v[1]:p+d}}return y}}(t,void 0,[])()}let l;const s=new Uint8Array(16);function d(){if(!l&&(l="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!l))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return l(s)}const f=[];for(let t=0;t<256;++t)f.push((t+256).toString(16).slice(1));var v={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function p(t,n,e){if(v.randomUUID&&!n&&!t)return v.randomUUID();const r=(t=t||{}).random||(t.rng||d)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,n){e=e||0;for(let t=0;t<16;++t)n[e+t]=r[t];return n}return function(t,n=0){return f[t[n+0]]+f[t[n+1]]+f[t[n+2]]+f[t[n+3]]+"-"+f[t[n+4]]+f[t[n+5]]+"-"+f[t[n+6]]+f[t[n+7]]+"-"+f[t[n+8]]+f[t[n+9]]+"-"+f[t[n+10]]+f[t[n+11]]+f[t[n+12]]+f[t[n+13]]+f[t[n+14]]+f[t[n+15]]}(r)}var m="link-temp-to-be-card",y="zt-bookmark-link",h=new WeakSet;function k(t,n){return Array.isArray(t)?t.some((function(t){return k(t,n)})):(e=t,"RegExp"===(r=Object.prototype.toString.call(e)).substring(8,r.length-1)?function(t,n){return t.test(n)}(t,n):function(t,n){return t===n}(t,n));var e,r}function b(t){return/^http(s)*/.test(t)}var g=function(t){return void 0===t&&(t=""),t.split(" ").filter((function(t){return!!t.trim()}))},z=function(t,n){if(!t||!n)return!1;if(n.includes(" "))throw new Error("className should not contain space.");return t.classList.contains(n)},E=function(t,n){var e;t&&n.trim()&&(e=t.classList).add.apply(e,g(n))};exports.addClass=E,exports.classNameToArray=g,exports.default=function(n){void 0===n&&(n={openMode:"blank"});var e=null!=n?n:{},r=e.defaultIcon,o=void 0===r?"https://bpic.588ku.com/element_origin_min_pic/00/72/81/9356def45e71de5.jpg":r;e.openMode;var i=e.skeletonWrapClass,a=e.dataWrapClass,c=e.loadInfoApi,l=e.timeout,s=void 0===l?3e4:l;function d(t){var n=t.target;n.setAttribute("src",o),n.removeEventListener("error",d)}function f(e){var r,u,l=null!==(r=null==e?void 0:e.getAttribute("href"))&&void 0!==r?r:"";if(b(l)){z(e,y)||E(e,y);var f=null!==(u=null==e?void 0:e.textContent)&&void 0!==u?u:l,v=function(t){var e=document.createElement("div");if(E(e,"zt-card-bookmark loading"),i){var r=i.split(" ").shift();z(e,r)||E(e,r)}return e.innerHTML='<a class="zt-card-bookmark-link" href="'.concat(t,'" target="').concat("self"===n.openMode?"_self":"_blank",'">\n    <div class="zt-card-bookmark-details">\n      <div class="zt-card-bookmark-content">\n      <div class="zt-card-bookmark-image"></div>\n      <div class="zt-card-bookmark-body">\n      <div class="zt-card-bookmark-title"></div>\n      <div class="zt-card-bookmark-desc"></div>\n      </div>\n    </div>\n   </div></a>'),e}(l);e.replaceWith(v);var m={title:f,url:l,icon:o,desc:l};new Promise((function(n,e){null==c||c(l).then((function(e){n(t(t({},m),e))}),(function(){n(m)})),setTimeout((function(){n(m)}),s)})).then((function(t){v.replaceWith(function(t,e){var r,o,i=document.createElement("div"),c=p();if(t.desc||(t.desc=null!=e?e:""),E(i,"zt-card-bookmark"),a){var u=a.split(" ").shift();z(i,u)||E(i,u)}return i.innerHTML='<a class="zt-card-bookmark-link" href="'.concat(t.url,'" target="').concat("self"===n.openMode?"_self":"_blank",'">\n    <div class="zt-card-bookmark-details">\n      <div class="zt-card-bookmark-content">\n      <img data-uid="').concat(c,'" class="zt-card-bookmark-image" src="').concat(t.icon,'" alt="icon" />\n      <div class="zt-card-bookmark-body">\n      <div class="zt-card-bookmark-title">\n      ').concat(null!==(r=null==t?void 0:t.title)&&void 0!==r?r:null==t?void 0:t.desc,'\n</div>\n      <div class="zt-card-bookmark-desc">').concat(null!==(o=null==t?void 0:t.desc)&&void 0!==o?o:t.url,"</div>\n      </div>\n    </div>\n   </div></a>"),setTimeout((function(){var t=document.querySelector('img[data-uid="'.concat(c,'"]'));t&&t.addEventListener("error",(function(t){d(t)}))}),0),i}(t))}))}}return{remark:function(t){return t.use((function(){return function(t,e){return function(t,n,e,r){let o,i,a;"function"==typeof n&&"function"!=typeof e?(i=void 0,a=n,o=e):(i=n,a=e,o=r),u(t,i,(function(t,n){const e=n[n.length-1],r=e?e.children.indexOf(t):void 0;return a(t,r,e)}),o)}(t,"link",(function(t,e,r){var o,i,a,c,u;if(!(n.exclude&&k(n.exclude,t.url)||!b(t.url))){var l=t.url,s="";"text"===(null!==(a=null===(i=null===(o=t.children)||void 0===o?void 0:o[0])||void 0===i?void 0:i.type)&&void 0!==a?a:"")&&(s=null!==(u=null===(c=t.children[0])||void 0===c?void 0:c.value)&&void 0!==u?u:"");var d=[{type:"text",value:s},{type:"element",tagName:"a",properties:{className:m,href:l},children:[{type:"text",value:s}]}];t.data||(t.data={}),t.data.hName="span",t.data.hChildren=d}})),t}})),t},viewerEffect:function(t){t.markdownBody;var n=document.getElementsByClassName(m);if(window.IntersectionObserver){var e=new IntersectionObserver((function(t,n){t.forEach((function(t){t.intersectionRatio<=0||(f(t.target),e.unobserve(t.target))}))}));Array.from(n).forEach((function(t){h.has(t)||(e.observe(t),h.add(t))})),console.log(e.takeRecords())}else Array.from(n).forEach((function(t){f(t)}))}}},exports.hasClass=z,exports.removeClass=function(t,n){var e;t&&n.trim()&&(e=t.classList).remove.apply(e,g(n))};
